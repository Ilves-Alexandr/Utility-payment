{"ast":null,"code":"import React,{useState,useEffect}from'react';import axios from'axios';import{useNavigate,useParams}from'react-router-dom';import{Box,Button,TextField,Typography,Alert}from'@mui/material';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const API_URL=process.env.REACT_APP_API_URL||\"http://localhost:5000\";const PostForm=isAuthenticated=>{const[title,setTitle]=useState('');const[content,setContent]=useState('');const[error,setError]=useState('');const{id}=useParams();const navigate=useNavigate();useEffect(()=>{if(id){const fetchPost=async()=>{try{const res=await axios.get(`${API_URL}/api/posts/${id}`,{headers:{Authorization:`Bearer ${localStorage.getItem('token')}`}});setTitle(res.data.title);setContent(res.data.content);}catch(err){console.error('Error fetching post:',err);setError(err.response?err.response.data.msg:'Something went wrong');}};fetchPost();}},[id]);const handleSubmit=async e=>{e.preventDefault();const postData={title,content};try{if(id){// Обновление поста\nawait axios.put(`${API_URL}/api/posts/${id}`,postData,{headers:{Authorization:`Bearer ${localStorage.getItem('token')}`}});}else{// Создание нового поста\nawait axios.post(`${API_URL}/api/posts`,postData,{headers:{Authorization:`Bearer ${localStorage.getItem('token')}`}});}navigate('/posts');}catch(err){console.error('Error saving post:',err);setError(err.response?err.response.data.msg:'Something went wrong');}};return isAuthenticated&&/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(Box,{sx:{maxWidth:600,margin:'auto',padding:4},children:[/*#__PURE__*/_jsx(Typography,{variant:\"h4\",gutterBottom:true,children:id?'Редактировать':'Создать'}),error&&/*#__PURE__*/_jsx(Alert,{severity:\"error\",sx:{marginBottom:2},children:error}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,children:[/*#__PURE__*/_jsx(TextField,{label:\"Title\",variant:\"outlined\",fullWidth:true,value:title,onChange:e=>setTitle(e.target.value),required:true,sx:{marginBottom:2}}),/*#__PURE__*/_jsx(TextField,{label:\"Content\",variant:\"outlined\",fullWidth:true,multiline:true,rows:4,value:content,onChange:e=>setContent(e.target.value),required:true,sx:{marginBottom:2}}),/*#__PURE__*/_jsx(Button,{type:\"submit\",variant:\"contained\",color:\"primary\",children:id?'Обновить':'Создать'})]})]})});};export default PostForm;","map":{"version":3,"names":["React","useState","useEffect","axios","useNavigate","useParams","Box","Button","TextField","Typography","Alert","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","API_URL","process","env","REACT_APP_API_URL","PostForm","isAuthenticated","title","setTitle","content","setContent","error","setError","id","navigate","fetchPost","res","get","headers","Authorization","localStorage","getItem","data","err","console","response","msg","handleSubmit","e","preventDefault","postData","put","post","children","sx","maxWidth","margin","padding","variant","gutterBottom","severity","marginBottom","onSubmit","label","fullWidth","value","onChange","target","required","multiline","rows","type","color"],"sources":["C:/Users/San/Desktop/projects/testTest — копия/client/src/components/PostForm.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport axios from 'axios';\r\nimport { useNavigate, useParams} from 'react-router-dom';\r\nimport { Box, Button, TextField, Typography, Alert } from '@mui/material';\r\n\r\nconst API_URL = process.env.REACT_APP_API_URL || \"http://localhost:5000\";\r\n\r\nconst PostForm = (isAuthenticated) => {\r\n  const [title, setTitle] = useState('');\r\n  const [content, setContent] = useState('');\r\n  const [error, setError] = useState('');\r\n  const { id } = useParams();\r\n  const navigate = useNavigate();\r\n\r\n  useEffect(() => {\r\n    if (id) {\r\n      const fetchPost = async () => {\r\n        try {\r\n          const res = await axios.get(`${API_URL}/api/posts/${id}`, {\r\n            headers: {\r\n              Authorization: `Bearer ${localStorage.getItem('token')}`,\r\n            },\r\n          });\r\n          setTitle(res.data.title);\r\n          setContent(res.data.content);\r\n        } catch (err) {\r\n          console.error('Error fetching post:', err);\r\n          setError(err.response ? err.response.data.msg : 'Something went wrong');\r\n        }\r\n      };\r\n\r\n      fetchPost();\r\n    }\r\n  }, [id]);\r\n\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n\r\n    const postData = { title, content };\r\n\r\n    try {\r\n      if (id) {\r\n        // Обновление поста\r\n        await axios.put(`${API_URL}/api/posts/${id}`, postData, {\r\n          headers: {\r\n            Authorization: `Bearer ${localStorage.getItem('token')}`,\r\n          },\r\n        });\r\n      } else {\r\n        // Создание нового поста\r\n        await axios.post(`${API_URL}/api/posts`, postData, {\r\n          headers: {\r\n            Authorization: `Bearer ${localStorage.getItem('token')}`,\r\n          },\r\n        });\r\n      }\r\n\r\n      navigate('/posts');\r\n    } catch (err) {\r\n      console.error('Error saving post:', err);\r\n      setError(err.response ? err.response.data.msg : 'Something went wrong');\r\n    }\r\n  };\r\n\r\n  return (\r\n    isAuthenticated && (  \r\n    <>\r\n      <Box sx={{ maxWidth: 600, margin: 'auto', padding: 4 }}>\r\n        <Typography variant=\"h4\" gutterBottom>\r\n          {id ? 'Редактировать' : 'Создать'}\r\n        </Typography>\r\n        \r\n        {error && (\r\n          <Alert severity=\"error\" sx={{ marginBottom: 2 }}>\r\n            {error}\r\n          </Alert>\r\n        )}\r\n        \r\n        <form onSubmit={handleSubmit}>\r\n          <TextField\r\n            label=\"Title\"\r\n            variant=\"outlined\"\r\n            fullWidth\r\n            value={title}\r\n            onChange={(e) => setTitle(e.target.value)}\r\n            required\r\n            sx={{ marginBottom: 2 }}\r\n          />\r\n          <TextField\r\n            label=\"Content\"\r\n            variant=\"outlined\"\r\n            fullWidth\r\n            multiline\r\n            rows={4}\r\n            value={content}\r\n            onChange={(e) => setContent(e.target.value)}\r\n            required\r\n            sx={{ marginBottom: 2 }}\r\n          />\r\n          <Button type=\"submit\" variant=\"contained\" color=\"primary\">\r\n            {id ? 'Обновить' : 'Создать'}\r\n          </Button>\r\n        </form>\r\n      </Box>\r\n    </>)\r\n  );\r\n};\r\n\r\nexport default PostForm;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}